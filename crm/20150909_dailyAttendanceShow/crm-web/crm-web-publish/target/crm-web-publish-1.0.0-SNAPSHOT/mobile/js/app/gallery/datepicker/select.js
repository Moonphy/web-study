BTR.define(["require","exports","module"],function(e,t,n){n.exports=function(e){var t={inputClass:"",invalid:[],rtl:!1,group:!1,groupLabel:"Groups"};return e.mobiscroll.presetShort("select"),e.mobiscroll.presets.select=function(n){function N(){var t,n=0,r=[],o=[],u=[[]];return i.group?(i.rtl&&(n=1),e("optgroup",s).each(function(t){r.push(e(this).attr("label")),o.push(t)}),u[n]=[{values:r,keys:o,label:i.groupLabel}],t=f,n+=i.rtl?-1:1):t=s,r=[],o=[],e("option",t).each(function(){var t=e(this).attr("value");r.push(e(this).text()),o.push(t),e(this).prop("disabled")&&m.push(t)}),u[n]=[{values:r,keys:o,label:v}],u}function C(e,t){var r=[];if(o){var i=[],u=0;for(u in n._selectedValues)i.push(y[u]),r.push(u);S.val(i.join(", "))}else S.val(e),r=t?n.values[w]:null;t&&(h=!0,s.val(r).change())}function k(e){if(o&&e.hasClass("dw-v")&&e.closest(".dw").find(".dw-ul").index(e.closest(".dw-ul"))==w){var t=e.attr("data-val"),r=e.hasClass("dw-msel");return r?(e.removeClass("dw-msel").removeAttr("aria-selected"),delete n._selectedValues[t]):(e.addClass("dw-msel").attr("aria-selected","true"),n._selectedValues[t]=t),n.live&&C(t,!0),!1}}var r=e.extend({},n.settings),i=e.extend(n.settings,t,r),s=e(this),o=s.prop("multiple"),u=this.id+"_dummy",a=o?s.val()?s.val()[0]:e("option",s).attr("value"):s.val(),f=s.find('option[value="'+a+'"]').parent(),l=f.index()+"",c=l,h,p=e('label[for="'+this.id+'"]').attr("for",u),d=e('label[for="'+u+'"]'),v=i.label!==undefined?i.label:d.length?d.text():s.attr("name"),m=[],g=[],y={},b,w,E,S,x=i.readonly,T;i.group&&!e("optgroup",s).length&&(i.group=!1),i.invalid.length||(i.invalid=m),i.group?i.rtl?(b=1,w=0):(b=0,w=1):(b=-1,w=0),e("#"+u).remove(),S=e('<input type="text" id="'+u+'" class="'+i.inputClass+'" readonly />').insertBefore(s),e("option",s).each(function(){y[e(this).attr("value")]=e(this).text()}),n.attachShow(S);var L=s.val()||[],A=0;for(A;A<L.length;A++)n._selectedValues[L[A]]=L[A];return C(y[a]),s.off(".dwsel").on("change.dwsel",function(){h||n.setValue(o?s.val()||[]:[s.val()],!0),h=!1}).addClass("dw-hsel").attr("tabindex",-1).closest(".ui-field-contain").trigger("create"),n._setValue||(n._setValue=n.setValue),n.setValue=function(t,r,u,h,p){var d,v=e.isArray(t)?t[0]:t;a=v!==undefined?v:e("option",s).attr("value");if(o){n._selectedValues={};var m=0;for(m;m<t.length;m++)n._selectedValues[t[m]]=t[m]}i.group?(f=s.find('option[value="'+a+'"]').parent(),c=f.index(),d=i.rtl?[a,f.index()]:[f.index(),a],c!==l&&(i.wheels=N(),n.changeWheel([w]),l=c+"")):d=[a],n._setValue(d,r,u,h,p);if(r){var g=o?!0:a!==s.val();C(y[a],g)}},n.getValue=function(e){var t=e?n.temp:n.values;return t[w]},{width:50,wheels:T,headerText:!1,multiple:o,anchor:S,formatResult:function(e){return y[e[w]]},parseValue:function(){var t=s.val()||[],r=0;if(o){n._selectedValues={};for(r;r<t.length;r++)n._selectedValues[t[r]]=t[r]}return a=o?s.val()?s.val()[0]:e("option",s).attr("value"):s.val(),f=s.find('option[value="'+a+'"]').parent(),c=f.index(),l=c+"",i.group&&i.rtl?[a,c]:i.group?[c,a]:[a]},validate:function(t,r,u){if(r===undefined&&o){var h=n._selectedValues,p=0;e(".dwwl"+w+" .dw-li",t).removeClass("dw-msel").removeAttr("aria-selected");for(p in h)e(".dwwl"+w+' .dw-li[data-val="'+h[p]+'"]',t).addClass("dw-msel").attr("aria-selected","true")}if(r===b){c=n.temp[b];if(c!==l){f=s.find("optgroup").eq(c),c=f.index(),a=f.find("option").eq(0).val(),a=a||s.val(),i.wheels=N();if(i.group)return n.temp=i.rtl?[a,c]:[c,a],i.readonly=[i.rtl,!i.rtl],clearTimeout(E),E=setTimeout(function(){n.changeWheel([w],undefined,!0),i.readonly=x,l=c+""},u*1e3),!1}else i.readonly=x}else a=n.temp[w];var d=e(".dw-ul",t).eq(w);e.each(i.invalid,function(t,n){e('.dw-li[data-val="'+n+'"]',d).removeClass("dw-v")})},onBeforeShow:function(t){o&&i.counter&&(i.headerText=function(){var t=0;return e.each(n._selectedValues,function(){t++}),t+" "+i.selectedText}),i.wheels=N(),i.group&&(n.temp=i.rtl?[a,f.index()]:[f.index(),a])},onClear:function(t){n._selectedValues={},S.val(""),e(".dwwl"+w+" .dw-li",t).removeClass("dw-msel").removeAttr("aria-selected")},onMarkupReady:function(t){t.addClass("dw-select"),e(".dwwl"+b,t).on("mousedown touchstart",function(){clearTimeout(E)}),o&&(t.addClass("dwms"),e(".dwwl",t).eq(w).addClass("dwwms").attr("aria-multiselectable","true"),e(".dwwl",t).on("keydown",function(t){t.keyCode==32&&(t.preventDefault(),t.stopPropagation(),k(e(".dw-sel",this)))}),g=e.extend({},n._selectedValues))},onValueTap:k,onSelect:function(e){C(e,!0),i.group&&(n.values=null)},onCancel:function(){i.group&&(n.values=null),!n.live&&o&&(n._selectedValues=e.extend({},g))},onChange:function(e){n.live&&!o&&(S.val(e),h=!0,s.val(n.temp[w]).change())},onDestroy:function(){S.remove(),s.removeClass("dw-hsel").removeAttr("tabindex")}}},e}});