BTR.define(["require","exports","module"],function(e,t,n){n.exports=function(e){var t=e.mobiscroll,n=new Date,r={dateFormat:"mm/dd/yy",dateOrder:"mmddy",timeWheels:"hhiiA",timeFormat:"hh:ii A",startYear:n.getFullYear()-100,endYear:n.getFullYear()+1,monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],shortYearCutoff:"+10",monthText:"Month",dayText:"Day",yearText:"Year",hourText:"Hours",minuteText:"Minutes",secText:"Seconds",ampmText:"&nbsp;",nowText:"Now",showNow:!1,stepHour:1,stepMinute:1,stepSecond:1,separator:" "},i=function(n){function q(e,t,n){return x[t]!==undefined?+e[x[t]]:n!==undefined?n:_[T[t]]?_[T[t]]():T[t](_)}function R(e,t,n,r){e.push({values:n,keys:t,label:r})}function U(e,t){return Math.floor(e/t)*t}function z(e){var t=e.getHours();return t=O&&t>=12?t-12:t,U(t,D)}function W(e){return U(e.getMinutes(),P)}function X(e){return U(e.getSeconds(),H)}function V(e){return A&&e.getHours()>11?1:0}function J(e){var t=q(e,"h",0);return new Date(q(e,"y"),q(e,"m"),q(e,"d",1),q(e,"a")?t+12:t,q(e,"i",0),q(e,"s",0))}function K(t,n){return e(".dw-li",t).index(e('.dw-li[data-val="'+n+'"]',t))}function Q(t,n,r,i){return n<0?0:n>r?e(".dw-li",t).length:K(t,n)+i}var i=e(this),s={},o;if(i.is("input")){switch(i.attr("type")){case"date":o="yy-mm-dd";break;case"datetime":o="yy-mm-ddTHH:ii:ssZ";break;case"datetime-local":o="yy-mm-ddTHH:ii:ss";break;case"month":o="yy-mm",s.dateOrder="mmyy";break;case"time":o="HH:ii:ss"}var u=i.attr("min"),a=i.attr("max");u&&(s.minDate=t.parseDate(o,u)),a&&(s.maxDate=t.parseDate(o,a))}var f,l,c,h,p,d,v,m,g,y=e.extend({},n.settings),b=e.extend(n.settings,r,s,y),w=0,E=[],S=[],x={},T={y:"getFullYear",m:"getMonth",d:"getDate",h:z,i:W,s:X,a:V},N=b.preset,C=b.dateOrder,k=b.timeWheels,L=C.match(/D/),A=k.match(/a/i),O=k.match(/h/),M=N=="datetime"?b.dateFormat+b.separator+b.timeFormat:N=="time"?b.timeFormat:b.dateFormat,_=new Date,D=b.stepHour,P=b.stepMinute,H=b.stepSecond,B=b.minDate||new Date(b.startYear,0,1),j=b.maxDate||new Date(b.endYear,11,31,23,59,59);o=o||M;if(N.match(/date/i)){e.each(["y","m","d"],function(e,t){f=C.search(new RegExp(t,"i")),f>-1&&S.push({o:f,v:t})}),S.sort(function(e,t){return e.o>t.o?1:-1}),e.each(S,function(e,t){x[t.v]=e}),p=[];for(l=0;l<3;l++)if(l==x.y){w++,h=[],c=[],d=B.getFullYear(),v=j.getFullYear();for(f=d;f<=v;f++)c.push(f),h.push(C.match(/yy/i)?f:(f+"").substr(2,2));R(p,c,h,b.yearText)}else if(l==x.m){w++,h=[],c=[];for(f=0;f<12;f++){var F=C.replace(/[dy]/gi,"").replace(/mm/,f<9?"0"+(f+1):f+1).replace(/m/,f+1);c.push(f),h.push(F.match(/MM/)?F.replace(/MM/,'<span class="dw-mon">'+b.monthNames[f]+"</span>"):F.replace(/M/,'<span class="dw-mon">'+b.monthNamesShort[f]+"</span>"))}R(p,c,h,b.monthText)}else if(l==x.d){w++,h=[],c=[];for(f=1;f<32;f++)c.push(f),h.push(C.match(/dd/i)&&f<10?"0"+f:f);R(p,c,h,b.dayText)}E.push(p)}if(N.match(/time/i)){g=!0,S=[],e.each(["h","i","s","a"],function(e,t){e=k.search(new RegExp(t,"i")),e>-1&&S.push({o:e,v:t})}),S.sort(function(e,t){return e.o>t.o?1:-1}),e.each(S,function(e,t){x[t.v]=w+e}),p=[];for(l=w;l<w+4;l++)if(l==x.h){w++,h=[],c=[];for(f=0;f<(O?12:24);f+=D)c.push(f),h.push(O&&f==0?12:k.match(/hh/i)&&f<10?"0"+f:f);R(p,c,h,b.hourText)}else if(l==x.i){w++,h=[],c=[];for(f=0;f<60;f+=P)c.push(f),h.push(k.match(/ii/)&&f<10?"0"+f:f);R(p,c,h,b.minuteText)}else if(l==x.s){w++,h=[],c=[];for(f=0;f<60;f+=H)c.push(f),h.push(k.match(/ss/)&&f<10?"0"+f:f);R(p,c,h,b.secText)}else if(l==x.a){w++;var I=k.match(/A/);R(p,[0,1],I?["AM","PM"]:["am","pm"],b.ampmText)}E.push(p)}return n.setDate=function(e,t,r,i){var s;for(s in x)n.temp[x[s]]=e[T[s]]?e[T[s]]():T[s](e);n.setValue(n.temp,t,r,i)},n.getDate=function(e){return J(e?n.temp:n.values)},n.convert=function(t){var n=t;return e.isArray(t)||(n=[],e.each(t,function(t,r){e.each(r,function(e,r){t==="daysOfWeek"&&(r.d?r.d="w"+r.d:r="w"+r),n.push(r)})})),n},n.format=M,n.buttons.now={text:b.nowText,css:"dwb-n",handler:function(){n.setDate(new Date,!1,.3,!0,!0)}},b.showNow&&b.buttons.splice(e.inArray("set",b.buttons)+1,0,"now"),m=b.invalid?n.convert(b.invalid):!1,{wheels:E,headerText:b.headerText?function(e){return t.formatDate(M,J(n.temp),b)}:!1,formatResult:function(e){return t.formatDate(o,J(e),b)},parseValue:function(e){var n=t.parseDate(o,e,b),r,i=[];for(r in x)i[x[r]]=n[T[r]]?n[T[r]]():T[r](n);return i},validate:function(t,r,i,s){var o=n.temp,u={y:B.getFullYear(),m:0,d:1,h:0,i:0,s:0,a:0},a={y:j.getFullYear(),m:11,d:31,h:U(O?11:23,D),i:U(59,P),s:U(59,H),a:1},f={h:D,i:P,s:H,a:1},l=q(o,"y"),c=q(o,"m"),h=!0,p=!0;e.each(["y","m","d","a","h","i","s"],function(r,i){if(x[i]!==undefined){var f=u[i],d=a[i],v=31,g=q(o,i),y=e(".dw-ul",t).eq(x[i]);i=="d"&&(v=32-(new Date(l,c,32)).getDate(),d=v,L&&e(".dw-li",y).each(function(){var t=e(this),n=t.data("val"),r=(new Date(l,c,n)).getDay(),i=C.replace(/[my]/gi,"").replace(/dd/,n<10?"0"+n:n).replace(/d/,n);e(".dw-i",t).html(i.match(/DD/)?i.replace(/DD/,'<span class="dw-day">'+b.dayNames[r]+"</span>"):i.replace(/D/,'<span class="dw-day">'+b.dayNamesShort[r]+"</span>"))})),h&&B&&(f=B[T[i]]?B[T[i]]():T[i](B)),p&&j&&(d=j[T[i]]?j[T[i]]():T[i](j));if(i!="y"){var w=K(y,f),E=K(y,d);e(".dw-li",y).removeClass("dw-v").slice(w,E+1).addClass("dw-v"),i=="d"&&e(".dw-li",y).removeClass("dw-h").slice(v).addClass("dw-h")}g<f&&(g=f),g>d&&(g=d),h&&(h=g==f),p&&(p=g==d);if(m&&i=="d"){var S,N,k,A,O=(new Date(l,c,1)).getDay(),M=[];for(N=0;N<m.length;N++){S=m[N],A=S+"";if(!S.start)if(S.getTime)S.getFullYear()==l&&S.getMonth()==c&&M.push(S.getDate()-1);else if(!A.match(/w/i))A=A.split("/"),A[1]?A[0]-1==c&&M.push(A[1]-1):M.push(A[0]-1);else{A=+A.replace("w","");for(k=A-O;k<v;k+=7)k>=0&&M.push(k)}}e.each(M,function(t,n){e(".dw-li",y).eq(n).removeClass("dw-v")}),g=n.getValidCell(g,y,s).val}o[x[i]]=g}});if(g&&m){var d,v,y,w,E,S,N,k,A,M,_,F,I,R,z,W,X={},V=q(o,"d"),J=new Date(l,c,V),G=["a","h","i","s"];e.each(m,function(e,t){t.start&&(t.apply=!1,d=t.d,v=d+"",w=v.split("/"),d&&(d.getTime&&l==d.getFullYear()&&c==d.getMonth()&&V==d.getDate()||!v.match(/w/i)&&(w[1]&&V==w[1]&&c==w[0]-1||!w[1]&&V==w[0])||v.match(/w/i)&&J.getDay()==+v.replace("w",""))&&(t.apply=!0,X[J]=!0))}),e.each(m,function(r,i){if(i.start&&(i.apply||!i.d&&!X[J])){E=i.start.split(":"),S=i.end.split(":");for(N=0;N<3;N++)E[N]===undefined&&(E[N]=0),S[N]===undefined&&(S[N]=59),E[N]=+E[N],S[N]=+S[N];E.unshift(E[0]>11?1:0),S.unshift(S[0]>11?1:0),O&&(E[1]>=12&&(E[1]=E[1]-12),S[1]>=12&&(S[1]=S[1]-12)),F=!0,I=!0,e.each(G,function(r,i){if(x[i]!==undefined){y=q(o,i),z=0,W=0,M=0,_=undefined,R=e(".dw-ul",t).eq(x[i]);for(N=r+1;N<4;N++)E[N]>0&&(z=f[i]),S[N]<a[G[N]]&&(W=f[i]);k=U(E[r]+z,f[i]),A=U(S[r]-W,f[i]),F&&(M=Q(R,k,a[i],0)),I&&(_=Q(R,A,a[i],1)),(F||I)&&e(".dw-li",R).slice(M,_).removeClass("dw-v"),y=n.getValidCell(y,R,s).val,F=F&&y==U(E[r],f[i]),I=I&&y==U(S[r],f[i]),o[x[i]]=y}})}})}}}};return e.each(["date","time","datetime"],function(e,n){t.presets[n]=i,t.presetShort(n)}),t.formatDate=function(t,n,i){if(!n)return null;var s=e.extend({},r,i),o=function(e){var n=0;while(f+1<t.length&&t.charAt(f+1)==e)n++,f++;return n},u=function(e,t,n){var r=""+t;if(o(e))while(r.length<n)r="0"+r;return r},a=function(e,t,n,r){return o(e)?r[t]:n[t]},f,l="",c=!1;for(f=0;f<t.length;f++)if(c)t.charAt(f)=="'"&&!o("'")?c=!1:l+=t.charAt(f);else switch(t.charAt(f)){case"d":l+=u("d",n.getDate(),2);break;case"D":l+=a("D",n.getDay(),s.dayNamesShort,s.dayNames);break;case"o":l+=u("o",(n.getTime()-(new Date(n.getFullYear(),0,0)).getTime())/864e5,3);break;case"m":l+=u("m",n.getMonth()+1,2);break;case"M":l+=a("M",n.getMonth(),s.monthNamesShort,s.monthNames);break;case"y":l+=o("y")?n.getFullYear():(n.getYear()%100<10?"0":"")+n.getYear()%100;break;case"h":var h=n.getHours();l+=u("h",h>12?h-12:h==0?12:h,2);break;case"H":l+=u("H",n.getHours(),2);break;case"i":l+=u("i",n.getMinutes(),2);break;case"s":l+=u("s",n.getSeconds(),2);break;case"a":l+=n.getHours()>11?"pm":"am";break;case"A":l+=n.getHours()>11?"PM":"AM";break;case"'":o("'")?l+="'":c=!0;break;default:l+=t.charAt(f)}return l},t.parseDate=function(t,n,i){var s=e.extend({},r,i),o=s.defaultValue||new Date;if(!t||!n)return o;n=typeof n=="object"?n.toString():n+"";var u=s.shortYearCutoff,a=o.getFullYear(),f=o.getMonth()+1,l=o.getDate(),c=-1,h=o.getHours(),p=o.getMinutes(),d=0,v=-1,m=!1,g=function(e){var n=S+1<t.length&&t.charAt(S+1)==e;return n&&S++,n},y=function(e){g(e);var t=e=="@"?14:e=="!"?20:e=="y"?4:e=="o"?3:2,r=new RegExp("^\\d{1,"+t+"}"),i=n.substr(E).match(r);return i?(E+=i[0].length,parseInt(i[0],10)):0},b=function(e,t,r){var i=g(e)?r:t,s;for(s=0;s<i.length;s++)if(n.substr(E,i[s].length).toLowerCase()==i[s].toLowerCase())return E+=i[s].length,s+1;return 0},w=function(){E++},E=0,S;for(S=0;S<t.length;S++)if(m)t.charAt(S)=="'"&&!g("'")?m=!1:w();else switch(t.charAt(S)){case"d":l=y("d");break;case"D":b("D",s.dayNamesShort,s.dayNames);break;case"o":c=y("o");break;case"m":f=y("m");break;case"M":f=b("M",s.monthNamesShort,s.monthNames);break;case"y":a=y("y");break;case"H":h=y("H");break;case"h":h=y("h");break;case"i":p=y("i");break;case"s":d=y("s");break;case"a":v=b("a",["am","pm"],["am","pm"])-1;break;case"A":v=b("A",["am","pm"],["am","pm"])-1;break;case"'":g("'")?w():m=!0;break;default:w()}a<100&&(a+=(new Date).getFullYear()-(new Date).getFullYear()%100+(a<=(typeof u!="string"?u:(new Date).getFullYear()%100+parseInt(u,10))?0:-100));if(c>-1){f=1,l=c;do{var x=32-(new Date(a,f-1,32)).getDate();if(l<=x)break;f++,l-=x}while(!0)}h=v==-1?h:v&&h<12?h+12:!v&&h==12?0:h;var T=new Date(a,f-1,l,h,p,d);return T.getFullYear()!=a||T.getMonth()+1!=f||T.getDate()!=l?o:T},e}});