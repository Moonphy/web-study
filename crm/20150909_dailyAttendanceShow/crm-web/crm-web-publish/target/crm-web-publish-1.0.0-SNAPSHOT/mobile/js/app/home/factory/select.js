BTR.define(["require","exports","module","../../base/index","../../gallery/datepicker/api","../../gallery/moment/main","../../gallery/iscroll/api","../../gallery/template/main","../../nav/nav","../../gallery/iscroll/list-api","text!./select-list-item.tpl"],function(e,t,n){var r=e("../../base/index"),i=e("../../gallery/datepicker/api"),s=e("../../gallery/moment/main"),o=e("../../gallery/iscroll/api"),u=e("../../gallery/template/main"),a=r.$,f=e("../../nav/nav"),l=new f({title:"选择汽修厂",prev:{text:'<a href="../task/add.html"><i class="icon iconfont">&#xe61f;</i>新增任务</a>'}});l.init();var c=e("../../gallery/iscroll/list-api");a(function(){function t(){return p.template||(p.template=e("text!./select-list-item.tpl")),p.template}i.init(a);var n=a("#J_nav"),s=a(".J_trigger");n.on(r.events.click,".J_trigger",function(){var e=a(this);e.hasClass("J_t2")||(location.href="select2.html"),s.removeClass("active"),e.addClass("active")});var f=a("#J_result_list"),l=a("#J_search_in"),h=a(".icon2"),p={},d=new c({loadDataContainer:f,container:"#J_result_list",url:"/wx/task/search/custServiceMfcty",buildParam:function(){return"?key="+a.trim(l.val())+"&size="+d.size+"&current="+d.current},success:function(e){return r.state.check(e,function(e){if(e){e.model||(e.model=[]),a.each(e.model,function(e,t){t.taskId="",t.factoryName=t.mfctyName,t.custID=t.id,t.id=t.mfctyID});var n=u.compile(t());d.appendData(n(e)),r.mobileDevice&&a("#wrapper").off(r.events.click,".item a").on(r.events.click,".item a",function(e){location.href=a(this).attr("href")})}}),e.model},search:!0,searchInId:"J_search_in",searchClose:".search .icon2",searchCallback:function(){d.settings.loadFirst=!0,d.loadData()},loadedCallback:function(){console.log("数据加载完了"),v.scroll&&v.scroll.refresh()},canDel:!1}),v=new o({id:"#wrapper",pulldownAction:function(){d.refresh()},pullupAction:function(){var e=this;d.loadNext(function(){e.refresh()})}});v.initialize(),d.initialize(),a("#scroller").on(r.events.over,"li.item",function(){a(this).css({background:"#ddd"})}).on(r.events.out,"li.item",function(){a(this).css({background:"#fff"})}),r.data.set("curr_factory_ismain",!1),r.pageLoaded()})});