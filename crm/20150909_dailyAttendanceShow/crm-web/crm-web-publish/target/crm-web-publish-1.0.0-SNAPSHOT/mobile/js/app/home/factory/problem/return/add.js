BTR.define(["require","exports","module","../../../../base/index","../../../../nav/nav","../../../../gallery/datepicker/api"],function(e,t,n){var r=e("../../../../base/index"),i=r.$,s=e("../../../../nav/nav"),o=e("../../../../gallery/datepicker/api"),u=new s({prev:{text:'<a href="list.html"><i class="icon iconfont">&#xe61f;</i>退货问题</a>'},title:"新增退货问题",op:{id:"J_save",text:"保存"}});u.init(),i(function(){function t(e){i.each(e,function(e,t){t.on("change",function(){i(this).val(i(this).val()+":"+(new Date).getSeconds())})})}function f(){var e=i.trim(s.val()),t=i.trim(u.val()),o=i.trim(n.val()),f=i.trim(a.val());if(r.check.null(e)){r.msg.info("请选择退货日期啊，亲");return}if(r.check.null(t)){r.msg.info("请输入订单号啊，亲");return}if(r.check.null(o)||o=="-1"){r.msg.info("请选择问题类型啊，亲");return}if(r.check.null(f)){r.msg.info("请输入具体描述啊，亲");return}var l={returnTypeID:o,returnGoodsTime:e,orderNo:t,content:f,TaskID:r.data.get("curr_taskid")};return r.utils.toQueryString(l)}o.init(i);var e=r.data.get("curr_taskid");r.check.null(e)&&r.msg.info("未检测到当前TASKID，请返回！",2e3),i("#J_date").scroller("destroy").scroller({theme:"sense-ui",lang:"zh",preset:"datetime",stepMinute:5}),t([i("#J_date")]);var n=i("#J_type"),s=i("#J_date"),u=i("#J_no"),a=i("#J_desc");i.ajax({url:"/wx/returnGoodsQuestion/getQuestionType",success:function(e){r.state.check(e,function(e){e||(e=[]);if(e.length>0){var t="";i.each(e,function(e,n){t+='<option value="{{value}}">{{text}}</option>'.replace("{{value}}",n.typeID).replace("{{text}}",n.typeName)}),n.append(t)}})}}),i("#J_save").on(r.events.click,function(){var e=f();if(e==undefined)return;i.ajax({url:"/wx/returnGoodsQuestion/create",data:e,type:"POST",success:function(e){r.state.check(e,function(){r.msg.success("问题已提交，感谢反馈",2e3,function(){location.href="list.html"})})}})}),r.pageLoaded()})});