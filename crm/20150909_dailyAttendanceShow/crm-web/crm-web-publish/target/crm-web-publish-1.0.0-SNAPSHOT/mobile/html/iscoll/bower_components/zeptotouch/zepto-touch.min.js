(function(e){function t(e,t,n,r){return Math.abs(e-t)>=Math.abs(n-r)?e-t>0?"Left":"Right":n-r>0?"Up":"Down"}function n(){c=null,u.last&&(u.el.trigger("longTap"),u={})}function r(){c&&clearTimeout(c),c=null}function i(){a&&clearTimeout(a),f&&clearTimeout(f),l&&clearTimeout(l),c&&clearTimeout(c),a=f=l=c=null,u={}}function s(e){return(e.pointerType=="touch"||e.pointerType==e.MSPOINTER_TYPE_TOUCH)&&e.isPrimary}function o(e,t){return e.type=="pointer"+t||e.type.toLowerCase()=="mspointer"+t}var u={},a,f,l,c,h=750,p;e(document).ready(function(){var d,v,m=0,g=0,y,b;"MSGesture"in window&&(p=new MSGesture,p.target=document.body),e(document).bind("MSGestureEnd",function(e){var t=e.velocityX>1?"Right":e.velocityX<-1?"Left":e.velocityY>1?"Down":e.velocityY<-1?"Up":null;t&&(u.el.trigger("swipe"),u.el.trigger("swipe"+t))}).on("touchstart MSPointerDown pointerdown",function(t){if((b=o(t,"down"))&&!s(t))return;y=b?t:t.touches[0],t.touches&&t.touches.length===1&&u.x2&&(u.x2=undefined,u.y2=undefined),d=Date.now(),v=d-(u.last||d),u.el=e("tagName"in y.target?y.target:y.target.parentNode),a&&clearTimeout(a),u.x1=y.pageX,u.y1=y.pageY,v>0&&v<=250&&(u.isDoubleTap=!0),u.last=d,c=setTimeout(n,h),p&&b&&p.addPointer(t.pointerId)}).on("touchmove MSPointerMove pointermove",function(e){if((b=o(e,"move"))&&!s(e))return;y=b?e:e.touches[0],r(),u.x2=y.pageX,u.y2=y.pageY,m+=Math.abs(u.x1-u.x2),g+=Math.abs(u.y1-u.y2)}).on("touchend MSPointerUp pointerup",function(n){if((b=o(n,"up"))&&!s(n))return;r(),u.x2&&Math.abs(u.x1-u.x2)>30||u.y2&&Math.abs(u.y1-u.y2)>30?l=setTimeout(function(){u.el.trigger("swipe"),u.el.trigger("swipe"+t(u.x1,u.x2,u.y1,u.y2)),u={}},0):"last"in u&&(m<30&&g<30?f=setTimeout(function(){var t=e.Event("tap");t.cancelTouch=i,u.el.trigger(t),u.isDoubleTap?(u.el&&u.el.trigger("doubleTap"),u={}):a=setTimeout(function(){a=null,u.el&&u.el.trigger("singleTap"),u={}},250)},0):u={}),m=g=0}).on("touchcancel MSPointerCancel pointercancel",i),e(window).on("scroll",i)}),["swipe","swipeLeft","swipeRight","swipeUp","swipeDown","doubleTap","tap","singleTap","longTap"].forEach(function(t){e.fn[t]=function(e){return this.on(t,e)}})})(Zepto);