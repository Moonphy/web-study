BTR.define(["require","exports","module","../../../base/index","touch","../../../nav/nav","../../../gallery/iscroll/api","../../../gallery/template/main","../../../gallery/iscroll/list-api","text!./list-item.tpl"],function(e,t,n){var r=e("../../../base/index"),i=r.$;e("touch")(i);var s=e("../../../nav/nav"),o=e("../../../gallery/iscroll/api"),u=e("../../../gallery/template/main"),a=new s({prev:{text:'<a href="../my.html"><i class="icon iconfont">&#xe61f;</i>我</a>'},title:"通讯录",op:{text:'<a href="add.html"><i class="icon iconfont">&#xe63b;</i></a>'}});a.init();var f=e("../../../gallery/iscroll/list-api");i(function(){function l(){return a.template||(a.template=e("text!./list-item.tpl")),a.template}var t=i("#J_result_list"),n=i("#J_search_in"),s="0",a={},c=new f({loadDataContainer:t,url:"/wx/phone/find/own/all",buildParam:function(){return"?key="+i.trim(n.val())+"&size="+c.size+"&current="+c.current},success:function(e){return r.state.check(e,function(e){if(e){e.model||(e.model=[]),e.isPublic=s;var t=u.compile(l());c.appendData(t(e)),r.mobileDevice&&i("#wrapper").off(r.events.click,".item a").on(r.events.click,".item a",function(e){location.href=i(this).attr("href")})}}),e.model},container:"#J_result_list",search:!0,searchInId:"J_search_in",searchClose:".search .icon2",searchCallback:function(){c.settings.loadFirst=!0,c.loadData()},loadedCallback:function(){console.log("数据加载完了"),h.scroll&&h.scroll.refresh(),r.pageLoaded()},canDel:!0,delCallback:function(){if(!confirm("您确定删除此联系人信息吗？"))return;var e=i(this).parents("li.item");i.ajax({url:"/wx/phone/del/userPhone",type:"POST",data:"contactID="+e.attr("data-id"),success:function(t){r.state.check(t,function(){e.remove()})}})}}),h=new o({id:"#wrapper",pulldownAction:function(){c.refresh()},pullupAction:function(){var e=this;c.loadNext(function(){e.refresh()})}});h.initialize(),c.initialize(),t.on(r.events.over,"li.item",function(){i(this).css({background:"#ddd"})}).on(r.events.out,"li.item",function(){i(this).css({background:"#fff"})})})});