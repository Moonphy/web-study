BTR.define(["require","exports","module","../../base/index","touch","../../nav/nav","../../footer/footer","../../gallery/iscroll/api","../../gallery/template/main","../../gallery/moment/main","../../gallery/iscroll/list-api","text!./list-item.tpl"],function(e,t,n){var r=e("../../base/index"),i=r.$;e("touch")(i);var s=e("../../nav/nav"),o=e("../../footer/footer"),u=e("../../gallery/iscroll/api"),a=e("../../gallery/template/main"),f=e("../../gallery/moment/main"),l=new s({title:"拜访"}),c=new o;l.init(),c.init();var h=e("../../gallery/iscroll/list-api");i(function(){function l(){return o.template||(o.template=e("text!./list-item.tpl")),o.template}var t=i("#J_result_list"),n=i("#J_search_in"),s=i(".icon2"),o={},c=new h({loadDataContainer:t,url:"/wx/task/find/mfctyNamelist",buildParam:function(){return"?key="+i.trim(n.val())+"&size="+c.size+"&current="+c.current},success:function(e){return r.state.check(e,function(e){if(e){e.model?i.each(e.model,function(e,t){var n=f(t.planTime),r=t.mfctyName;t.time=n.format("HH:mm"),t.date=n.format("YYYY-MM-DD"),t._mfctyName=r&&r.length>8?r.slice(0,8):r}):e.model=[];var t=a.compile(l());c.appendData(t(e)),r.mobileDevice&&i("#wrapper").off(r.events.click,".item a").on(r.events.click,".item a",function(e){location.href=i(this).attr("href")})}}),e.model},container:"#J_result_list",search:!0,searchInId:"J_search_in",searchClose:".icon2",searchCallback:function(){c.settings.loadFirst=!0,c.loadData()},loadedCallback:function(){console.log("数据加载完了"),p.scroll&&p.scroll.refresh()},canDel:!1}),p=new u({id:"#wrapper",pulldownAction:function(){c.refresh()},pullupAction:function(){var e=this;c.loadNext(function(){e.refresh()})}});p.initialize(),c.initialize(),t.on(r.events.over,"li.item",function(){i(this).css({background:"#ddd"})}).on(r.events.out,"li.item",function(){i(this).css({background:"#fff"})});var d=i("#J_accidentcar_remind");i.ajax({url:"/wx/accidentCarsRemain/remain",success:function(e){r.state.check(e,function(e){e==1&&d.find(".my_icon").attr("class","my_icon clock2")})}}),i(".content .item").on(r.events.over,function(e){i(this).addClass("active")}).on(r.events.out,function(e){i(this).removeClass("active")}),r.pageLoaded()})});