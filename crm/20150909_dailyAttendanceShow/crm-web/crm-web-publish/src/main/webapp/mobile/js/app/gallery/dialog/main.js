BTR.define(["require","exports","module","zepto","../mask/main","css!./dialog.css","text!./main.tpl","zepto"],function(e,t,n){var r=e("zepto");Mask=e("../mask/main"),function(t,r,i){e("css!./dialog.css");var s=t(r),o=!1,u=function(e){this.settings=t.extend({},u.defaults,e),this.init()};u.defaults={clsPrefix:"ui-dialog",content:"加载中...",title:"load",width:"auto",height:"auto",ok:null,cancel:null,onclose:null,ondestory:null,okText:"确定",cancelText:"取消",time:null,lock:!0,zIndex:9999},u.prototype={init:function(){this.settings.lock&&this.lock(),this.dialog?this.dialog.show():this.create(),!isNaN(this.settings.time)&&this.settings.time!=null&&this.time()},create:function(){var n=e("text!./main.tpl"),r=this.settings.title,i="";switch(r){case"load":i="faa-spin animated faa-slow"}n=n.replace(/\{title\}/,r).replace(/\{prefix\}/g,this.settings.clsPrefix).replace(/\{animate\}/g,i).replace(/\{content\}/,this.settings.content),this.dialog=t("<div>").addClass(this.settings.clsPrefix).css({zIndex:this.settings.zIndex++}).html(n).prependTo("body"),t.isFunction(this.settings.ok)&&this.ok(),t.isFunction(this.settings.cancel)&&this.cancel(),this.size(),this.position()},ok:function(){var e=this,n=this.dialog.find("."+this.settings.clsPrefix+"-footer");t("<a>",{href:"javascript:;",text:this.settings.okText}).on("click",function(){var t=e.settings.ok();(t==i||t)&&e.close()}).addClass("ui-dialog-ok").prependTo(n)},cancel:function(){var e=this,n=this.dialog.find(".ui-dialog-footer");t("<a>",{href:"javascript:;",text:this.settings.cancelText}).on("click",function(){var t=e.settings.cancel();(t==i||t)&&e.close()}).addClass("ui-dialog-cancel").appendTo(n)},onClose:function(){t.isFunction(this.settings.onclose)&&this.settings.onclose()},onDestory:function(){t.isFunction(this.settings.ondestory)&&this.settings.ondestory()},size:function(){var e=this.dialog.find(".ui-dialog-content"),t=this.dialog.find(".ui-dialog-wrap");e.css({width:this.settings.width,height:this.settings.height})},position:function(){var e=this,t=s.width(),n=s.height(),r=0;this.dialog.css({left:(t-e.dialog.width())/2,top:(n-e.dialog.height())/2+r})},lock:function(){this.mask?this.mask.show():this.mask=Mask(),this.clock=!0},close:function(e){this.settings.lock&&this.clock&&(e?this.mask.close():this.mask.destory()),e?(this.dialog.remove(),this.onDestory()):(this.dialog.hide(),this.onClose())},destory:function(){},time:function(){var e=this;this.closeTimer=setTimeout(function(){e.close()},this.settings.time)},show:function(){this.init()}},n.exports=u}(e("zepto"),window)});