BTR.define(["require","exports","module","../../../../base/index","../../../../gallery/datepicker/api","../../../../nav/nav","../../../../gallery/template/main","text!./list-item.tpl"],function(e,t,n){var r=e("../../../../base/index"),i=r.$,s=e("../../../../gallery/datepicker/api"),o=e("../../../../nav/nav"),u=e("../../../../gallery/template/main"),a='<a href="../../my.html"><i class="icon iconfont">&#xe61f;</i>我</a>',f=new o({prev:{id:"J_prev",text:a},title:"事故车提醒",op:{id:"J_more",text:"更多"}});f.init(),i(function(){function t(){return cache.template||(cache.template=e("text!./list-item.tpl")),cache.template}s.init(i),$title=i("#navbar").find(".title"),$J_search=i("#J_search"),$closeIcon=i(".search .icon2"),$J_prev_text=a,$J_list=i("#J_list"),$J_more=i("#J_more"),$J_prev=i("#J_prev"),$J_search_in=i("#J_search_in"),$car=i(".car"),cache={};var n=function(e){e==undefined&&(e=""),i.ajax({url:"/wx/accidentCarsRemain/find/RemainList",data:"key="+e+"&size=1000",success:function(e){r.state.check(e,function(e){e.model||(e.model=[]);var n=u.compile(t());$J_list.html(n(e))})}})};n(),$J_more.on(r.events.click,function(){var e=i(this);$J_search.show(),e.hide(),$title.text("事故车历史"),$J_prev.html('<i class="icon iconfont">&#xe61f;</i>返回').off(r.events.click).on(r.events.click,function(){i(this).html($J_prev_text),$J_search.hide(),e.show(),$title.text("事故车提醒")})}),$J_list.on(r.events.click,".car",function(e){o(this)});var o=function(e){e=i(e);var t=e.attr("data-id"),n=e.find(".remind-icon");if(!t||t==undefined||t=="")return;n.hasClass("active")&&window.confirm("确定将该条事故车提醒状态更改为已读吗？")&&i.ajax({url:"/wx/accidentCarsRemain/read",data:"accidentCarID="+t,success:function(t){r.state.check(t,function(){e.find(".remind-icon").removeClass("active").addClass("complete")})}})};$J_search_in.scroller("destroy").scroller({preset:"date",stepMinute:5,theme:"sense-ui",lang:"zh"}),$J_search_in.on("change",function(){var e=i(this).val();n(e),e?$closeIcon.show():$closeIcon.hide()}),$closeIcon.on(r.events.click,function(){$J_search_in.val(""),$J_search_in.trigger("change"),i(this).hide()}),r.pageLoaded()})});