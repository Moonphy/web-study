BTR.define(["require","exports","module"],function(e,t,n){n.exports=function(e,t,n){var r={$SHENG:t("#J_sheng"),$SHI:t("#J_shi"),$QU:t("#J_qu"),$TEXT:t("li div.value span"),RS:t("ul.chosen-results")},i=n.debug.getSuffix(),s=t.extend(r,e||{}),o={};t.extend(o.load={},{loadProvince:function(e){t.ajax({url:"/base/province/find/all"+i,success:function(r){n.state.check(r,function(n){e.empty(),n||(n=[]);var r="";n.length>0?t.each(n,function(e,t){r+='<li class="active-result" value="{{id}}">{{val}}</li>'.replace("{{id}}",t.proId).replace("{{val}}",t.proName)}):r+='<li class="active-result" value="-1">无结果</li>',e.append(r)},function(e){n.msg.info(e)})}})},loadCity:function(e,r){if(r==undefined){e.empty().append('<li class="active-result" value="-1">请选择省份</li>');return}t.ajax({url:"/base/city/find/{proId}".replace("{proId}",r)+i,success:function(r){n.state.check(r,function(n){e.empty(),n||(n=[]);var r="";n.length>0?t.each(n,function(e,t){r+='<li class="active-result" value="{{id}}">{{val}}</li>'.replace("{{id}}",t.cityId).replace("{{val}}",t.cityName)}):r+='<li class="active-result" value="-1">无结果</li>',e.append(r)},function(e){n.msg.info(e)})}})},loadArea:function(e,r,o){o&&t(s.$TEXT[2]).data("id",undefined);if(r==undefined){e.empty().append('<li class="active-result" value="-1">请选择市级</li>');return}t.ajax({url:"/base/area/find/{cityId}".replace("{cityId}",r)+i,success:function(r){n.state.check(r,function(n){e.empty(),n||(n=[]);var r="";n.length>0?t.each(n,function(e,t){r+='<li class="active-result" value="{{id}}">{{val}}</li>'.replace("{{id}}",t.areaId).replace("{{val}}",t.areaName)}):r+='<li class="active-result" value="-1">无结果</li>',e.append(r)},function(e){n.msg.info(e)})}})}}),o.load.loadProvince(s.$SHENG.find("ul.chosen-results")),o.initializeSel=function(e,r){var i=e,a=t(".chosen-drop"),f=i.find(".chosen-drop");i.on(n.CLICK,function(){a.hide(),i.find("li.active-result").length>0&&f.css({display:"inline-block"})}).on(n.events.over,"li",function(){t(this).addClass("highlighted")}).on(n.events.out,"li",function(){t(this).removeClass("highlighted")}).on(n.events.click,"li",function(){var e=t(this),r=e.text(),u=e.val(),a=i.find("div.value span");a.text(r),a.data("id",u),n.log("你选择了："+r,"值为："+u),f.hide();var l=i.data("level");switch(l){case 1:t(s.$TEXT[1]).text("请选择"),t(s.$TEXT[2]).text("请选择"),o.load.loadCity(t(s.RS[1]),u),o.load.loadArea(t(s.RS[2]),undefined,!0);break;case 2:t(s.$TEXT[2]).text("请选择"),o.load.loadArea(t(s.RS[2]),u,!0);break;default:}}).data("level",r),t(document).on(n.CLICK,function(e){!t(e.target).hasClass("item")&&t(e.target).parents("li").length<=0&&a.hide()}),r==1&&(t(s.$TEXT[0]).text(u.proName),t(s.$TEXT[1]).text(u.cityName),t(s.$TEXT[2]).text(u.areaName),o.load.loadCity(t(s.RS[1]),u.proId),o.load.loadArea(t(s.RS[2]),u.cityId,!1),t(s.$TEXT[0]).data("id",u.proId),t(s.$TEXT[1]).data("id",u.cityId),t(s.$TEXT[2]).data("id",u.areaId))};var u={};return t.ajax({url:"/wx/user/find/fullArea",async:!1,success:function(e){n.state.check(e,function(e){u=e})}}),o.initializeSel(s.$SHENG,1),o.initializeSel(s.$SHI,2),o.initializeSel(s.$QU,3),o}});